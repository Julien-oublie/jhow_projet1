
{% extends 'base.html.twig' %}

{% block title %}User{% endblock %}

{% block body %}

<h1>{{ app.user.pseudo }}</h1>
<h3>Personnages : </h3> 
 <button><a href="{{ path('personnage_new') }}">Créer un nouveau personnage</a></button>
      <br>
    {% for personnages in app.user.personnages %}
           <a href="{{ path('personnage_generate_fiche', {'id': personnages.id} ) }}">Voir la fiche complète du personnage</a>
           <div>{{personnages.nom }}</div>
           <div>{{personnages.classe }}</div> 
           <div>Parties jouées: {{personnages.partie|length}}</div>
            <br>
    {% endfor %}
    <hr>
    <br>
    nombre de parties jouées: {{app.user.parties|length}}
   
    <button><a href="{{ path('app_partie_new') }}">Créer une nouvelle partie</a></button>
    <a href="{{ path('app_user_edit', {'id': user.id}) }}">edit</a>
    {{ include('user/_delete_form.html.twig') }}
      <br>
    <hr>
   

      <h3>Ajouter un ami:</h3>  
      <br>
      {{form_start(form, {'action': path('app_user_show', {'id': app.user.id}), 'method': 'POST'})}}
      {{ form_row(form) }} 
      <input type="hidden" id="path_friend" value='{{ path('app_user_show', {'id': user.id}) }}'>
      <button type="submit" id="submit_friend">Rechercher</button>
      {{ form_end(form) }}
      {% set deja_ami = null %}


      {% if joueur_recherche != 'null'%} {# Si il y a une recherche de pseudo #}  
           {% if joueur_recherche and joueur_recherche.pseudo != app.user.pseudo  %} {# Si le pseudo existe et est différent de celui du user #}
              <b>{{joueur_recherche.pseudo}}</b>
              {% for amis in app.user.amities %}
                  {% if amis.Ami2.id == joueur_recherche.id %}
                    {% set deja_ami = true %}
                  {% endif %} 
              {% endfor %}
              
              {% if deja_ami %}
                Vous etes déjà amis !
              {% else %}
                <button>
                  <a href="{{ path('app_user_show', {'id': user.id, 'joueur_ami':joueur_recherche.id}) }}">
                    Ajouter
                  </a>
                </button>
              {% endif %}

             
        {% else %}
          Pas de joueur trouvé
        {% endif %}
      {% endif %}
      
      <hr>
      <br>
      <h3>Mes amis:</h3>
      <ul>
      
      {% for amis in app.user.amities %}
         <li>{{ amis.ami2.pseudo }}</li>
      {% endfor %}
      </ul>



{% endblock %}
