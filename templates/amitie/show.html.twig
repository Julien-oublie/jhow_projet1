{% extends 'base.html.twig' %}

{% block title %}Mes amis{% endblock %}

{% block body %}
<div class="replaceAjaxContent">
        <div class="banniereAmis">
          <h1>Ajouter un ami</h1>  
          <br>
          <span class="form_style">
            {{form_start(form, {'action': path('app_user_show', {'id': app.user.id}), 'method': 'POST', 'attr' : {'id': 'formFriends'} })}}
            <span class="inputFriendStyle"></span> 
            {{ form_row(form) }} 
              <input type="hidden" id="path_friend" value='{{ path('view_friend', {'id': user.id}) }}'>
              <button type="submit" id="submit_friend"><i class="fa-solid fa-magnifying-glass"></i></button>
            {{ form_end(form) }}
            <div class="loaderFriends">
              <div>
               <img src="{{ asset('https://cdn.discordapp.com/attachments/968448853160386591/969249957485875250/One_Ring_Blender_Render.png')}}"/>
              </div>
              <span>Chargement... </span>
            </div>
            {% set deja_ami = null %}
            {% if joueur_recherche != 'null'%} {# Si il y a une recherche de pseudo #}  
              <div class="ResultFriend">
                  {% if joueur_recherche and joueur_recherche.pseudo != app.user.pseudo  %} {# Si le pseudo existe et est différent de celui du user #}
                      <b>{{joueur_recherche.pseudo}}</b>
                      {% for amis in app.user.amities %}
                          {% if amis.Ami2.id == joueur_recherche.id %}
                            {% set deja_ami = true %}
                          {% endif %} 
                      {% endfor %}
                      
                      {% if deja_ami %}
                      <div class="alreadyFriend"> 
                        <span class="resultJoueur">
                          <button disabled="disabled"> Vous etes déjà amis ! </button>
                        </span>
                      </div>
                      {% else %}
                    
                        <span class="resultJoueur">
                          <button id="ajaxAddFriend" class="btnAddFriend" value="{{ path('view_friend', {'id': user.id, 'joueur_ami':joueur_recherche.id}) }}">
                             Ajouter
                          </button>
                        </span>
                    
                      {% endif %}
                {% else %}
                  <div class="noneJoueur"> 
                    <span class="error"> Erreur</span>
                    <br>
                    <span class="resultJoueur">Pas de joueur trouvé. Réessayer.</span>
                  </div>
                {% endif %}
              </div>
            {% endif %}
            
            </span>
        </div>
        <div class="barre"><br><br></div>

      <div class="friend-content">
        
        {% for amis in app.user.amities %}
          <div class="ResultAllFriend">
             <b>{{ amis.ami2.pseudo }}</b> 
            <button  value="{{ path('delet_friend', {'amitie_id': amis.id}) }}" class="deletFriend"> <img src="https://cdn.discordapp.com/attachments/968448853160386591/970040649564954644/icons8-cross-mark-96.png"/></button>
          </div>
        {% endfor %}
        
      </div>
  </div>
<script>
</script>


{% endblock %}